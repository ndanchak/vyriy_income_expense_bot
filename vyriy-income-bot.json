{
  "name": "Vyriy House ‚Äî Telegram Income Bot",
  "flow": [
    {
      "id": 1,
      "module": "telegram-bot-sdk:TriggerNewUpdates",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}",
        "filter": "message"
      },
      "mapper": {},
      "metadata": {
        "designer": { "x": 0, "y": 0 },
        "restore": {},
        "expect": [
          { "name": "message", "type": "collection" }
        ]
      },
      "label": "Watch Group Messages"
    },
    {
      "id": 2,
      "module": "builtin:BasicFeeder",
      "version": 1,
      "parameters": {},
      "filter": {
        "name": "Has Photo?",
        "conditions": [
          [
            {
              "a": "{{1.message.photo}}",
              "o": "exist"
            }
          ]
        ]
      },
      "mapper": {},
      "metadata": {
        "designer": { "x": 200, "y": 0 },
        "restore": {}
      },
      "label": "Filter: Photo Only"
    },
    {
      "id": 3,
      "module": "telegram-bot-sdk:GetFile",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}"
      },
      "mapper": {
        "file_id": "{{last(1.message.photo).file_id}}"
      },
      "metadata": {
        "designer": { "x": 400, "y": 0 },
        "restore": {}
      },
      "label": "Get Photo File"
    },
    {
      "id": 4,
      "module": "http:ActionSendData",
      "version": 3,
      "parameters": {
        "handleErrors": true
      },
      "mapper": {
        "url": "https://api.telegram.org/file/bot{{connection.telegram.token}}/{{3.file_path}}",
        "method": "GET",
        "bodyType": "raw",
        "parseResponse": false
      },
      "metadata": {
        "designer": { "x": 600, "y": 0 },
        "restore": {}
      },
      "label": "Download Photo as Binary"
    },
    {
      "id": 5,
      "module": "http:ActionSendData",
      "version": 3,
      "parameters": {
        "handleErrors": true,
        "showAdvanced": true
      },
      "mapper": {
        "url": "https://vision.googleapis.com/v1/images:annotate?key={{connection.google_vision_api_key}}",
        "method": "POST",
        "headers": [
          { "name": "content-type", "value": "application/json" }
        ],
        "bodyType": "raw",
        "contentType": "application/json",
        "body": "{\"requests\":[{\"image\":{\"content\":\"{{toBase64(4.data)}}\"},\"features\":[{\"type\":\"TEXT_DETECTION\",\"maxResults\":1}],\"imageContext\":{\"languageHints\":[\"uk\",\"ru\"]}}]}",
        "parseResponse": true
      },
      "metadata": {
        "designer": { "x": 800, "y": 0 },
        "restore": {}
      },
      "label": "Google Vision OCR ‚Äî Extract Text"
    },
    {
      "id": 6,
      "module": "builtin:SetVariable",
      "version": 1,
      "parameters": {},
      "mapper": {
        "name": "raw_ocr_text",
        "value": "{{5.data.responses[].fullTextAnnotation.text}}"
      },
      "metadata": {
        "designer": { "x": 900, "y": 0 },
        "restore": {}
      },
      "label": "Extract Raw OCR Text"
    },
    {
      "id": 6,
      "module": "builtin:SetVariable",
      "version": 1,
      "parameters": {},
      "mapper": {
        "name": "parsed",
        "scope": "roundtrip",
        "value": {
          "sender_name": "{{trim(replace(replace(regexGet(6.raw_ocr_text, '(?:–í—ñ–¥|–≤—ñ–¥|–û—Ç|–≤—ñ–¥ –∫–æ–≥–æ)[:\\s]+([^\\n]+)', 1), '–í—ñ–¥:', ''), '–≤—ñ–¥:', ''))}}",
          "amount": "{{toNumber(replace(replace(regexGet(6.raw_ocr_text, '([\\d\\s]+[,.]?\\d*)\\s*(?:‚Ç¥|–≥—Ä–Ω|UAH)', 1), ' ', ''), ',', '.'))}}",
          "currency": "UAH",
          "date": "{{regexGet(6.raw_ocr_text, '(\\d{2}[./]\\d{2}[./]\\d{4})', 1)}}",
          "purpose": "{{trim(regexGet(6.raw_ocr_text, '(?:–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è|–ö–æ–º–µ–Ω—Ç–∞—Ä|–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è|–ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è)[:\\s]+([^\\n]+)', 1))}}"
        }
      },
      "metadata": {
        "designer": { "x": 1000, "y": 0 },
        "restore": {}
      },
      "label": "Parse Fields from OCR Text"
    },
    {
      "id": 7,
      "module": "telegram-bot-sdk:ActionSendMessage",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}"
      },
      "mapper": {
        "chat_id": "{{1.message.chat.id}}",
        "text": "üí≥ *–û—Ç—Ä–∏–º–∞–Ω–æ –ø–ª–∞—Ç—ñ–∂*\n\nüë§ –í—ñ–¥: {{6.sender_name}}\nüí∞ –°—É–º–∞: {{6.amount}} {{6.currency}}\nüìÖ –î–∞—Ç–∞: {{6.date}}\nüìù –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è: {{6.purpose}}\n\nüè† *–î–æ —è–∫–æ–≥–æ –æ–±'—î–∫—Ç—É –≤—ñ–¥–Ω–æ—Å–∏—Ç—å—Å—è?*",
        "parse_mode": "Markdown",
        "reply_markup": "{\"inline_keyboard\":[[{\"text\":\"üè† –ì–Ω—ñ–∑–¥–µ—á–∫–æ\",\"callback_data\":\"prop_gnizd\"},{\"text\":\"üê¶ –ß–∞–π–∫–∞\",\"callback_data\":\"prop_chaika\"}],[{\"text\":\"ü¶¢ –ß–∞–ø–ª—è\",\"callback_data\":\"prop_chaplia\"},{\"text\":\"üèÑ SUP Rental\",\"callback_data\":\"prop_sup\"}],[{\"text\":\"‚è≠ –ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏\",\"callback_data\":\"prop_skip\"}]]}"
      },
      "metadata": {
        "designer": { "x": 1200, "y": 0 },
        "restore": {}
      },
      "label": "Ask: Property"
    },
    {
      "id": 8,
      "module": "telegram-bot-sdk:TriggerNewUpdates",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}",
        "filter": "callback_query"
      },
      "mapper": {},
      "metadata": {
        "designer": { "x": 1400, "y": 0 },
        "restore": {}
      },
      "label": "Wait: Property Button Press"
    },
    {
      "id": 9,
      "module": "telegram-bot-sdk:ActionAnswerCallbackQuery",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}"
      },
      "mapper": {
        "callback_query_id": "{{8.callback_query.id}}"
      },
      "metadata": {
        "designer": { "x": 1600, "y": 0 },
        "restore": {}
      },
      "label": "Dismiss Loading Spinner"
    },
    {
      "id": 10,
      "module": "builtin:BasicRouter",
      "version": 1,
      "parameters": {},
      "mapper": {},
      "metadata": {
        "designer": { "x": 1800, "y": 0 },
        "restore": {}
      },
      "label": "Router: Property Type"
    },
    {
      "id": 11,
      "module": "telegram-bot-sdk:ActionSendMessage",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}"
      },
      "filter": {
        "name": "Is SUP?",
        "conditions": [[{ "a": "{{8.callback_query.data}}", "o": "equal", "b": "prop_sup" }]]
      },
      "mapper": {
        "chat_id": "{{1.message.chat.id}}",
        "text": "üèÑ *SUP Rental ‚Äî –æ–±–µ—Ä—ñ—Ç—å —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å:*",
        "parse_mode": "Markdown",
        "reply_markup": "{\"inline_keyboard\":[[{\"text\":\"‚è± 1 –≥–æ–¥–∏–Ω–∞\",\"callback_data\":\"dur_1h\"},{\"text\":\"‚è± 2 –≥–æ–¥–∏–Ω–∏\",\"callback_data\":\"dur_2h\"}],[{\"text\":\"‚è± 3 –≥–æ–¥–∏–Ω–∏\",\"callback_data\":\"dur_3h\"},{\"text\":\"üåÖ –ü—ñ–≤ –¥–Ω—è (4–≥)\",\"callback_data\":\"dur_halfday\"}],[{\"text\":\"‚òÄÔ∏è –í–µ—Å—å –¥–µ–Ω—å\",\"callback_data\":\"dur_fullday\"},{\"text\":\"‚è≠ –ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏\",\"callback_data\":\"dur_skip\"}]]}"
      },
      "metadata": {
        "designer": { "x": 2000, "y": -200 },
        "restore": {}
      },
      "label": "Ask: SUP Duration"
    },
    {
      "id": 12,
      "module": "telegram-bot-sdk:TriggerNewUpdates",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}",
        "filter": "callback_query"
      },
      "mapper": {},
      "metadata": {
        "designer": { "x": 2200, "y": -200 },
        "restore": {}
      },
      "label": "Wait: Duration Button Press"
    },
    {
      "id": 13,
      "module": "telegram-bot-sdk:ActionAnswerCallbackQuery",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}"
      },
      "mapper": {
        "callback_query_id": "{{12.callback_query.id}}"
      },
      "metadata": {
        "designer": { "x": 2400, "y": -200 },
        "restore": {}
      },
      "label": "Dismiss SUP Spinner"
    },
    {
      "id": 14,
      "module": "telegram-bot-sdk:ActionSendMessage",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}"
      },
      "filter": {
        "name": "Is Property (not SUP)?",
        "conditions": [[
          { "a": "{{8.callback_query.data}}", "o": "not-equal", "b": "prop_sup" },
          { "a": "{{8.callback_query.data}}", "o": "not-equal", "b": "prop_skip" }
        ]]
      },
      "mapper": {
        "chat_id": "{{1.message.chat.id}}",
        "text": "üí≥ *–¢–∏–ø –ø–ª–∞—Ç–µ–∂—É:*",
        "parse_mode": "Markdown",
        "reply_markup": "{\"inline_keyboard\":[[{\"text\":\"üí∞ –ü–µ—Ä–µ–¥–æ–ø–ª–∞—Ç–∞\",\"callback_data\":\"pay_prepay\"},{\"text\":\"üíµ –î–æ–ø–ª–∞—Ç–∞\",\"callback_data\":\"pay_balance\"}],[{\"text\":\"‚úÖ –û–ø–ª–∞—Ç–∞ (–ø–æ–≤–Ω–∞)\",\"callback_data\":\"pay_full\"},{\"text\":\"‚è≠ –ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏\",\"callback_data\":\"pay_skip\"}]]}"
      },
      "metadata": {
        "designer": { "x": 2000, "y": 0 },
        "restore": {}
      },
      "label": "Ask: Payment Type (Property)"
    },
    {
      "id": 15,
      "module": "telegram-bot-sdk:TriggerNewUpdates",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}",
        "filter": "callback_query"
      },
      "mapper": {},
      "metadata": {
        "designer": { "x": 2200, "y": 0 },
        "restore": {}
      },
      "label": "Wait: Payment Type Press"
    },
    {
      "id": 16,
      "module": "telegram-bot-sdk:ActionAnswerCallbackQuery",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}"
      },
      "mapper": {
        "callback_query_id": "{{15.callback_query.id}}"
      },
      "metadata": {
        "designer": { "x": 2400, "y": 0 },
        "restore": {}
      },
      "label": "Dismiss Payment Spinner"
    },
    {
      "id": 17,
      "module": "telegram-bot-sdk:ActionSendMessage",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}"
      },
      "mapper": {
        "chat_id": "{{1.message.chat.id}}",
        "text": "üìÖ *–í–≤–µ–¥—ñ—Ç—å –¥–∞—Ç–∏ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è* (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ):\n\n–§–æ—Ä–º–∞—Ç:\n`–ß–ï–ö-–Ü–ù: 22.02.2026`\n`–ß–ï–ö-–ê–£–¢: 25.02.2026`\n\n–ê–±–æ –Ω–∞–¥—ñ—à–ª—ñ—Ç—å ‚è≠ –¥–ª—è –ø—Ä–æ–ø—É—Å–∫—É",
        "parse_mode": "Markdown",
        "reply_markup": "{\"inline_keyboard\":[[{\"text\":\"‚è≠ –ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –¥–∞—Ç–∏\",\"callback_data\":\"dates_skip\"}]]}"
      },
      "metadata": {
        "designer": { "x": 2600, "y": 0 },
        "restore": {}
      },
      "label": "Ask: Check-in / Check-out"
    },
    {
      "id": 18,
      "module": "telegram-bot-sdk:TriggerNewUpdates",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}",
        "filter": "message"
      },
      "mapper": {},
      "metadata": {
        "designer": { "x": 2800, "y": 0 },
        "restore": {}
      },
      "label": "Wait: Dates Text or Skip"
    },
    {
      "id": 19,
      "module": "telegram-bot-sdk:ActionSendMessage",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}"
      },
      "mapper": {
        "chat_id": "{{1.message.chat.id}}",
        "text": "üåê *–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:*",
        "parse_mode": "Markdown",
        "reply_markup": "{\"inline_keyboard\":[[{\"text\":\"üì∏ Instagram (INST)\",\"callback_data\":\"plat_inst\"},{\"text\":\"üè® Booking.com (BC)\",\"callback_data\":\"plat_bc\"}],[{\"text\":\"‚úàÔ∏è Airbnb\",\"callback_data\":\"plat_airbnb\"},{\"text\":\"üîó HutsHub\",\"callback_data\":\"plat_hutshub\"}],[{\"text\":\"üìû –ü—Ä—è–º–∏–π –¥–∑–≤—ñ–Ω–æ–∫\",\"callback_data\":\"plat_direct\"},{\"text\":\"‚è≠ –ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏\",\"callback_data\":\"plat_skip\"}]]}"
      },
      "metadata": {
        "designer": { "x": 3000, "y": 0 },
        "restore": {}
      },
      "label": "Ask: Platform"
    },
    {
      "id": 20,
      "module": "telegram-bot-sdk:TriggerNewUpdates",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}",
        "filter": "callback_query"
      },
      "mapper": {},
      "metadata": {
        "designer": { "x": 3200, "y": 0 },
        "restore": {}
      },
      "label": "Wait: Platform Button Press"
    },
    {
      "id": 21,
      "module": "telegram-bot-sdk:ActionAnswerCallbackQuery",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}"
      },
      "mapper": {
        "callback_query_id": "{{20.callback_query.id}}"
      },
      "metadata": {
        "designer": { "x": 3400, "y": 0 },
        "restore": {}
      },
      "label": "Dismiss Platform Spinner"
    },
    {
      "id": 22,
      "module": "builtin:SetVariable",
      "version": 1,
      "parameters": {},
      "mapper": {
        "name": "property_label",
        "value": "{{switch(8.callback_query.data, 'prop_gnizd', '–ì–Ω—ñ–∑–¥–µ—á–∫–æ', 'prop_chaika', '–ß–∞–π–∫–∞', 'prop_chaplia', '–ß–∞–ø–ª—è', 'prop_sup', 'SUP Rental', '')}}"
      },
      "metadata": {
        "designer": { "x": 3600, "y": 0 },
        "restore": {}
      },
      "label": "Map: Property Label"
    },
    {
      "id": 23,
      "module": "builtin:SetVariable",
      "version": 1,
      "parameters": {},
      "mapper": {
        "name": "payment_type_label",
        "value": "{{switch(15.callback_query.data, 'pay_prepay', '–ü–µ—Ä–µ–¥–æ–ø–ª–∞—Ç–∞', 'pay_balance', '–î–æ–ø–ª–∞—Ç–∞', 'pay_full', '–û–ø–ª–∞—Ç–∞', '')}}"
      },
      "metadata": {
        "designer": { "x": 3800, "y": 0 },
        "restore": {}
      },
      "label": "Map: Payment Type Label"
    },
    {
      "id": 24,
      "module": "builtin:SetVariable",
      "version": 1,
      "parameters": {},
      "mapper": {
        "name": "platform_label",
        "value": "{{switch(20.callback_query.data, 'plat_inst', 'INST', 'plat_bc', 'BC', 'plat_airbnb', 'Airbnb', 'plat_hutshub', 'HutsHub', 'plat_direct', 'Direct', '')}}"
      },
      "metadata": {
        "designer": { "x": 4000, "y": 0 },
        "restore": {}
      },
      "label": "Map: Platform Label"
    },
    {
      "id": 25,
      "module": "builtin:SetVariable",
      "version": 1,
      "parameters": {},
      "mapper": {
        "name": "sup_duration_label",
        "value": "{{switch(12.callback_query.data, 'dur_1h', '1 –≥–æ–¥–∏–Ω–∞', 'dur_2h', '2 –≥–æ–¥–∏–Ω–∏', 'dur_3h', '3 –≥–æ–¥–∏–Ω–∏', 'dur_halfday', '–ü—ñ–≤ –¥–Ω—è (4–≥)', 'dur_fullday', '–í–µ—Å—å –¥–µ–Ω—å', '')}}"
      },
      "metadata": {
        "designer": { "x": 4200, "y": -200 },
        "restore": {}
      },
      "label": "Map: SUP Duration Label"
    },
    {
      "id": 26,
      "module": "builtin:SetVariable",
      "version": 1,
      "parameters": {},
      "mapper": {
        "name": "checkin_date",
        "value": "{{if(contains(18.message.text, '–ß–ï–ö-–Ü–ù'), trim(split(split(18.message.text, '–ß–ï–ö-–Ü–ù:')[1], '\n')[0]), '')}}"
      },
      "metadata": {
        "designer": { "x": 4000, "y": 200 },
        "restore": {}
      },
      "label": "Parse: Check-in Date"
    },
    {
      "id": 27,
      "module": "builtin:SetVariable",
      "version": 1,
      "parameters": {},
      "mapper": {
        "name": "checkout_date",
        "value": "{{if(contains(18.message.text, '–ß–ï–ö-–ê–£–¢'), trim(split(split(18.message.text, '–ß–ï–ö-–ê–£–¢:')[1], '\n')[0]), '')}}"
      },
      "metadata": {
        "designer": { "x": 4200, "y": 200 },
        "restore": {}
      },
      "label": "Parse: Check-out Date"
    },
    {
      "id": 28,
      "module": "builtin:SetVariable",
      "version": 1,
      "parameters": {},
      "mapper": {
        "name": "account_type",
        "value": "{{if(8.callback_query.data = 'prop_sup', if(contains(toLower(6.purpose), '–≥–æ—Ç—ñ–≤–∫–∞'), 'Cash', 'Account'), 'Account')}}"
      },
      "metadata": {
        "designer": { "x": 4400, "y": 0 },
        "restore": {}
      },
      "label": "Map: Account Type"
    },
    {
      "id": 29,
      "module": "builtin:SetVariable",
      "version": 1,
      "parameters": {},
      "mapper": {
        "name": "month_label",
        "value": "{{formatDate(parseDate(6.date, 'DD.MM.YYYY'), 'MMMM YYYY')}}"
      },
      "metadata": {
        "designer": { "x": 4600, "y": 0 },
        "restore": {}
      },
      "label": "Calculate: Month Label"
    },
    {
      "id": 30,
      "module": "google-sheets:ActionAddRow",
      "version": 2,
      "parameters": {
        "config": "{{connection.google_sheets}}"
      },
      "mapper": {
        "spreadsheetId": "YOUR_SPREADSHEET_ID_HERE",
        "sheetName": "–î–æ—Ö–æ–¥–∏",
        "values": {
          "Date": "{{formatDate(parseDate(6.date, 'DD.MM.YYYY'), 'YYYY-MM-DD')}} 0:00:00",
          "Day#": "",
          "Amount": "{{6.amount}}",
          "Property": "{{22.property_label}}",
          "Platform": "{{24.platform_label}}",
          "Guest Name": "{{6.sender_name}}",
          "Nights": "",
          "Check-in": "{{26.checkin_date}}",
          "Check-out": "{{27.checkout_date}}",
          "Payment Type": "{{if(8.callback_query.data = 'prop_sup', '–°–∞–ø–∏', 23.payment_type_label)}}",
          "Account Type": "{{28.account_type}}",
          "Notes": "{{if(8.callback_query.data = 'prop_sup', concat('–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: ', 25.sup_duration_label), 6.purpose)}}",
          "Month": "{{29.month_label}}"
        }
      },
      "metadata": {
        "designer": { "x": 4800, "y": 0 },
        "restore": {}
      },
      "label": "Google Sheets ‚Äî Add Income Row"
    },
    {
      "id": 31,
      "module": "telegram-bot-sdk:ActionSendMessage",
      "version": 1,
      "parameters": {
        "config": "{{connection.telegram}}"
      },
      "mapper": {
        "chat_id": "{{1.message.chat.id}}",
        "text": "{{if(8.callback_query.data = 'prop_sup', concat('‚úÖ *SUP Rental –∑–∞–ø–∏—Å–∞–Ω–æ*\n\nüèÑ –û–±\\'—î–∫—Ç: SUP Rental\nüí∞ –°—É–º–∞: ', 6.amount, ' ', 6.currency, '\nüë§ –í—ñ–¥: ', 6.sender_name, '\n‚è± –¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: ', 25.sup_duration_label, '\nüìÖ –î–∞—Ç–∞: ', 6.date, '\nüóÇ –¢–∏–ø: –°–∞–ø–∏'), concat('‚úÖ *–ó–∞–ø–∏—Å–∞–Ω–æ –≤ Google Sheets*\n\nüè† –û–±\\'—î–∫—Ç: ', 22.property_label, '\nüí∞ –°—É–º–∞: ', 6.amount, ' ', 6.currency, '\nüë§ –í—ñ–¥: ', 6.sender_name, '\nüí≥ –¢–∏–ø: ', 23.payment_type_label, '\nüåê –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞: ', 24.platform_label, if(26.checkin_date, concat('\nüìÖ –ß–µ–∫-—ñ–Ω: ', 26.checkin_date), ''), if(27.checkout_date, concat('\nüìÖ –ß–µ–∫-–∞—É—Ç: ', 27.checkout_date), ''), '\nüìÜ –ú—ñ—Å—è—Ü—å: ', 29.month_label)}}",
        "parse_mode": "Markdown"
      },
      "metadata": {
        "designer": { "x": 5000, "y": 0 },
        "restore": {}
      },
      "label": "Send Confirmation"
    }
  ],
  "metadata": {
    "instant": false,
    "version": 1,
    "scenario": {
      "roundtrips": 1,
      "maxErrors": 3,
      "autoCommit": true,
      "autoCommitTriggerLast": true,
      "sequential": false,
      "confidential": false,
      "dataloss": false,
      "dlq": false,
      "freshVariables": false
    },
    "designer": {
      "orphans": []
    }
  },
  "_vyriy_setup_notes": {
    "step_1_connections_needed": [
      "telegram ‚Äî create via BotFather, paste Bot Token",
      "google_vision_api_key ‚Äî from console.cloud.google.com, stored as URL query param variable",
      "google_sheets ‚Äî OAuth connection to your Google account"
    ],
    "step_2_enable_google_vision": "Go to console.cloud.google.com ‚Üí APIs & Services ‚Üí Enable 'Cloud Vision API' ‚Üí Create API Key ‚Üí store as connection.google_vision_api_key in Make.com",
    "step_3_replace_placeholder": "Replace YOUR_SPREADSHEET_ID_HERE in module 30 with your actual Google Sheets ID (found in the URL: docs.google.com/spreadsheets/d/SPREADSHEET_ID/edit)",
    "step_4_sheet_tab_name": "Make sure the tab in your Google Sheet is named exactly: –î–æ—Ö–æ–¥–∏",
    "step_5_column_headers_required": [
      "Date", "Day#", "Amount", "Property", "Platform",
      "Guest Name", "Nights", "Check-in", "Check-out",
      "Payment Type", "Account Type", "Notes", "Month"
    ],
    "step_6_ocr_parsing_note": "Module 5 sends image to Google Vision TEXT_DETECTION with Ukrainian language hint. Module 6 extracts raw text. Module 6b uses regex to parse sender_name, amount, date, purpose from Monobank's consistent layout. If a field is not found, regex returns empty string.",
    "step_7_SUP_flow": "SUP branch (modules 11-13, 25) runs instead of property modules 14-17 when prop_sup is selected. Duration is stored in Notes column as '–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: X'",
    "step_8_account_type_logic": "Account Type auto-sets to Cash if purpose contains '–≥–æ—Ç—ñ–≤–∫–∞', otherwise Account.",
    "step_9_dates_skip_handling": "If user presses '–ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –¥–∞—Ç–∏' button, module 18 catches the callback_query instead of text ‚Äî Check-in and Check-out will be empty strings in Sheets",
    "step_10_day_hash_and_nights": "Day# and Nights columns are left empty ‚Äî calculated via Sheets formulas",
    "ocr_used": "Google Cloud Vision API ‚Äî TEXT_DETECTION with languageHints: ['uk', 'ru']",
    "cost": "Google Vision: first 1000 images/month FREE, then $1.50 per 1000. At 100 images/month = $0.00"
  }
}
